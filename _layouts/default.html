<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">

{% seo %}
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          {% if site.github.is_project_page %}
            <a id="forkme_banner" href="{{ site.github.repository_url }}">View on GitHub</a>
          {% endif %}

          <span>
              <img class="header_logo" src="{{ '/assets/images/logo.svg' | relative_url }}">
              <h2 id="project_tagline" style='display:inline;'>{{ site.description | default: site.github.project_tagline }}</h2>
          </span>

          {% if site.show_downloads %}
            <section id="downloads">
              <a class="zip_download_link" href="{{ site.github.zip_url }}">Download this project as a .zip file</a>
              <a class="tar_download_link" href="{{ site.github.tar_url }}">Download this project as a tar.gz file</a>
            </section>
          {% endif %}
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="side_nav" class="inner">
        {% include toc.md %}    
      </section>
      <section id="main_content" class="inner">
        {{ content }}
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Â© 2020 California Institute of Technology. Government sponsorship acknowledged.</p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    <!-- 
    These are all failed attempts to make the collapsed/expanded states of sections persist across pages.
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const summaries = document.querySelectorAll('summary');

        summaries.forEach((summary) => {
          const section = summary.parentElement; // <details> element
          const itemKey = summary.textContent.trim(); // Use the section title as the cookie name

          // Check if the itemKey cookie exists
          if (document.cookie.includes(`${itemKey}=open`)) {
            section.setAttribute('open', 'open');
          }
          
          summary.addEventListener('click', function () {
            if (section.hasAttribute('open')) {
              document.cookie = `${itemKey}=open; path=/`; // Set the cookie
            } else {
              document.cookie = `${itemKey}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`; // Remove the cookie
            }
          });
        });
      });

    </script>
    
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const summaries = document.querySelectorAll('summary');

        summaries.forEach((summary) => {
          const section = summary.parentElement; // <details> element
          const itemKey = summary.textContent.trim(); // Use the section title as the localStorage key

          summary.addEventListener('click', function () {
            if (section.hasAttribute('open')) {
              localStorage.setItem(itemKey, 'open');
            } else {
              localStorage.removeItem(itemKey);
            }
          });

          // Check if the itemKey exists in localStorage
          if (localStorage.getItem(itemKey) === 'open') {
            section.setAttribute('open', 'open');
          }
        });
      });

    </script>
    
    failed script 1 
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const detailsSections = document.querySelectorAll('details');

        detailsSections.forEach(function(section) {
          const summary = section.querySelector('summary');
          const itemKey = summary.textContent.trim();
          const isActive = 'false';
          console.log('starting up with ', itemKey, isActive);          
          if (!(localStorage.getItem(itemKey))) {
            section.setAttribute('open', 'open');
            const isActive = 'true';
            console.log('went into the if loop for ', itemKey, isActive);
          }        
          
          summary.addEventListener('click', function() {
            const isActive = !section.hasAttribute('open');
            localStorage.setItem(itemKey, isActive);
            console.log(itemKey, isActive);
            console.log('in first loop, local storage says isActive is ', localStorage.getItem(itemKey));
          });
          console.log('in second loop, local storage says isActive is ', localStorage.getItem(itemKey));
        });
      });
    </script>-->
    
    {% if site.google_analytics %}
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', '{{ site.google_analytics }}', 'auto');
        ga('send', 'pageview');
      </script>
    {% endif %}
  </body>
</html>
